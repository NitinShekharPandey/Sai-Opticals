<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Customer Portal</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      width: 100%;
      max-width: 500px;
      animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      color: #2d3748;
      font-size: 32px;
      margin-bottom: 30px;
      text-align: center;
      font-weight: 600;
    }

    .button-group {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
    }

    button {
      flex: 1;
      padding: 14px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    button.active {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    }

    input {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      font-size: 15px;
      transition: all 0.3s ease;
      background: #f7fafc;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
      background: white;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .save-btn, .search-btn {
      width: 100%;
      margin-top: 10px;
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      box-shadow: 0 4px 15px rgba(72, 187, 120, 0.4);
    }

    .search-btn {
      background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
      box-shadow: 0 4px 15px rgba(66, 153, 225, 0.4);
    }

    #registerSection, #infoSection {
      display: none;
      animation: fadeIn 0.4s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .message {
      margin-top: 20px;
      padding: 12px;
      border-radius: 10px;
      text-align: center;
      font-weight: 500;
      display: none;
    }

    .message.show {
      display: block;
    }

    .message.success {
      background: #c6f6d5;
      color: #22543d;
    }

    .message.error {
      background: #fed7d7;
      color: #742a2a;
    }

    .customer-item {
      background: #f7fafc;
      padding: 16px;
      border-radius: 10px;
      margin-top: 20px;
      border-left: 4px solid #667eea;
    }

    .customer-detail {
      display: flex;
      justify-content: space-between;
      margin: 4px 0;
      font-size: 14px;
    }

    .detail-label {
      font-weight: 600;
      color: #4a5568;
    }

    .detail-value {
      color: #2d3748;
    }

    .empty-state {
      text-align: center;
      padding: 40px;
      color: #a0aec0;
      font-style: italic;
    }

    .search-box {
      margin-bottom: 0;
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>sai Opticals</h2>

    <div class="button-group">
      <button id="regBtn" class="active" onclick="showRegister()">Register</button>
      <button id="infoBtn" onclick="showInfo()">View All</button>
    </div>

    <div id="registerSection" style="display: block;">
      <input id="name" placeholder="Enter Name">
      <input id="age" placeholder="Enter Age">
      <input id="date" placeholder="Enter Date" type="date">
      <input id="number" placeholder="Enter Number">
      <input id="address" placeholder="Enter Address">
      <input id="power" placeholder="Enter Power">
      <input id="frame" placeholder="Enter Frame">
      <input id="framp" placeholder="Frame Price">
      <input id="lens" placeholder="Enter Lens">
      <input id="lenp" placeholder="Lens Price">
      <input id="total" placeholder="Total Amount">
      
      <button class="save-btn" onclick="saveCustomer()">Save Customer</button>
      <p class="message" id="msg"></p>
    </div>

    <div id="infoSection">
      <input id="searchName" class="search-box" placeholder="Search by Name">
      <button class="search-btn" onclick="searchCustomer()">Search</button>
      
      <div id="customerResult"></div>
    </div>
  </div>

  <script>
    // Initialize storage
    // async function saveCustomer() {
    //   const customer = {
    //     name: document.getElementById("name").value.trim(),
    //     age: document.getElementById("age").value.trim(),
    //     date: document.getElementById("date").value.trim(),
    //     number: document.getElementById("number").value.trim(),
    //     address: document.getElementById("address").value.trim(),
    //     power: document.getElementById("power").value.trim(),
    //     frame: document.getElementById("frame").value.trim(),
    //     framp: document.getElementById("framp").value.trim(),
    //     lens: document.getElementById("lens").value.trim(),
    //     lenp: document.getElementById("lenp").value.trim(),
    //     total: document.getElementById("total").value.trim()
    //   };

    //   const msg = document.getElementById("msg");

    //   if (!customer.name || !customer.number) {
    //     msg.className = "message error show";
    //     msg.innerText = "⚠️ Name and Number are required";
    //     return;
    //   }

    //   try {
    //     // Save to storage with name as key
    //     const key = `customer:${customer.name.toLowerCase().replace(/\s+/g, '_')}`;
    //     await window.storage.set(key, JSON.stringify(customer));
        
    //     msg.className = "message success show";
    //     msg.innerText = "✓ Customer saved successfully!";
        
    //     // Clear all inputs
    //     document.querySelectorAll('#registerSection input').forEach(input => input.value = "");
        
    //     setTimeout(() => msg.className = "message", 2000);
    //   } catch (error) {
    //     msg.className = "message error show";
    //     msg.innerText = "❌ Error saving customer: " + error.message;
    //   }
    // }

    function saveCustomer() {
  const customer = {
    name: document.getElementById("name").value.trim(),
    age: document.getElementById("age").value.trim(),
    date: document.getElementById("date").value.trim(),
    number: document.getElementById("number").value.trim(),
    address: document.getElementById("address").value.trim(),
    power: document.getElementById("power").value.trim(),
    frame: document.getElementById("frame").value.trim(),
    framp: document.getElementById("framp").value.trim(),
    lens: document.getElementById("lens").value.trim(),
    lenp: document.getElementById("lenp").value.trim(),
    total: document.getElementById("total").value.trim()
  };

  const msg = document.getElementById("msg");

  if (!customer.name || !customer.number) {
    msg.className = "message error show";
    msg.innerText = "⚠️ Name and Number are required";
    return;
  }

  const key = `customer:${customer.name.toLowerCase().replace(/\s+/g, '_')}`;
  localStorage.setItem(key, JSON.stringify(customer));

  msg.className = "message success show";
  msg.innerText = "✓ Customer saved successfully!";

  document.querySelectorAll('#registerSection input').forEach(input => input.value = "");

  setTimeout(() => msg.className = "message", 2000);
}

    async function searchCustomer() {
      const searchName = document.getElementById("searchName").value.trim();
      const resultDiv = document.getElementById("customerResult");

      if (!searchName) {
        resultDiv.innerHTML = '<p class="empty-state">Please enter a name to search</p>';
        return;
      }

      try {
        const key = `customer:${searchName.toLowerCase().replace(/\s+/g, '_')}`;
        const result = await window.storage.get(key);
        
        if (result && result.value) {
          const customer = JSON.parse(result.value);
          resultDiv.innerHTML = `
            <div class="customer-item">
              <div class="customer-detail"><span class="detail-label">Name:</span> <span class="detail-value">${customer.name}</span></div>
              <div class="customer-detail"><span class="detail-label">Age:</span> <span class="detail-value">${customer.age}</span></div>
              <div class="customer-detail"><span class="detail-label">Date:</span> <span class="detail-value">${customer.date}</span></div>
              <div class="customer-detail"><span class="detail-label">Number:</span> <span class="detail-value">${customer.number}</span></div>
              <div class="customer-detail"><span class="detail-label">Address:</span> <span class="detail-value">${customer.address}</span></div>
              <div class="customer-detail"><span class="detail-label">Power:</span> <span class="detail-value">${customer.power}</span></div>
              <div class="customer-detail"><span class="detail-label">Frame:</span> <span class="detail-value">${customer.frame}</span></div>
              <div class="customer-detail"><span class="detail-label">Frame Price:</span> <span class="detail-value">${customer.framp}</span></div>
              <div class="customer-detail"><span class="detail-label">Lens:</span> <span class="detail-value">${customer.lens}</span></div>
              <div class="customer-detail"><span class="detail-label">Lens Price:</span> <span class="detail-value">${customer.lenp}</span></div>
              <div class="customer-detail"><span class="detail-label">Total:</span> <span class="detail-value">${customer.total}</span></div>
            </div>
          `;
        } else {
          resultDiv.innerHTML = '<p class="empty-state">Customer not found</p>';
        }
      } catch (error) {
        resultDiv.innerHTML = '<p class="empty-state">Customer not found</p>';
      }
    }

    function showRegister() {
      document.getElementById("registerSection").style.display = "block";
      document.getElementById("infoSection").style.display = "none";
      document.getElementById("regBtn").classList.add("active");
      document.getElementById("infoBtn").classList.remove("active");
      document.getElementById("msg").className = "message";
    }

    function showInfo() {
      document.getElementById("registerSection").style.display = "none";
      document.getElementById("infoSection").style.display = "block";
      document.getElementById("infoBtn").classList.add("active");
      document.getElementById("regBtn").classList.remove("active");
      document.getElementById("customerResult").innerHTML = '';
      document.getElementById("searchName").value = '';
    }
  </script>
</body>
</html>